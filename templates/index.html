<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (Sprint 1-2)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .status-available {
            color: green;
            font-weight: bold;
        }

        .status-busy {
            color: red;
            font-weight: bold;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-body {
            padding: 2rem;
        }

        .booking-info {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .booking-info h6 {
            color: #666;
            margin-bottom: 0.5rem;
        }

        .booking-info p {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin: 0;
        }
    </style>
</head>

<body class="container py-5">
    <h1 class="mb-4">üìÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h1>

    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á</th>
                <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏</th>
                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                <th>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>
                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (Sprint 2)</th>
            </tr>
        </thead>
        <tbody>
            {% for room in rooms %}
            <tr>
                <td>{{ room.name }}</td>
                <td>{{ room.capacity }} ‡∏Ñ‡∏ô</td>

                <td>
                    {% if room.is_available %}
                    <span class="status-available">‡∏ß‡πà‡∏≤‡∏á</span>
                    {% else %}
                    <span class="status-busy">‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</span>
                    {% endif %}
                </td>
                <td>{{ room.booked_by }}</td>

                <td>
                    {% if room.is_available %}
                    <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal"
                        data-bs-target="#bookingModal{{ room.id }}" data-room-name="{{ room.name }}"
                        data-room-capacity="{{ room.capacity }}" data-room-id="{{ room.id }}">
                        üìù ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á
                    </button>
                    {% else %}
                    <form action="/cancel/{{ room.id }}" method="POST">
                        <button type="submit" class="btn btn-danger btn-sm">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    </form>
                    {% endif %}
                </td>
            </tr>

            <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á -->
            {% if room.is_available %}
            <div class="modal fade" id="bookingModal{{ room.id }}" tabindex="-1"
                aria-labelledby="bookingModalLabel{{ room.id }}" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="bookingModalLabel{{ room.id }}">
                                üè¢ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
                            </h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="booking-info">
                                <h6>üìç ‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</h6>
                                <p>{{ room.name }}</p>
                            </div>
                            <div class="booking-info">
                                <h6>üë• ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏</h6>
                                <p>{{ room.capacity }} ‡∏Ñ‡∏ô</p>
                            </div>

                            <form action="/book/{{ room.id }}" method="POST" id="bookingForm{{ room.id }}">
                                <div class="mb-3">
                                    <label for="bookerName{{ room.id }}" class="form-label">
                                        <strong>üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</strong>
                                    </label>
                                    <input type="text" class="form-control form-control-lg" id="bookerName{{ room.id }}"
                                        name="booker_name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á" required autocomplete="off">
                                    <div class="form-text">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button type="submit" form="bookingForm{{ room.id }}" class="btn btn-primary">
                                ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            {% endfor %}
        </tbody>
    </table>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>